<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>维修师傅</title>
<script type="text/javascript">
function showpage(page){
if (page==1)  {
	document.getElementById("page1").style.display="block";
	document.getElementById("page2").style.display="none";
	document.getElementById("page3").style.display="none";
	document.getElementById("page4").style.display="none";
	document.getElementById("page5").style.display="none";
	document.getElementById("page6").style.display="none";
}
if (page==2)  {
	document.getElementById("page2").style.display="block";
	document.getElementById("page1").style.display="none";
	document.getElementById("page3").style.display="none";
	document.getElementById("page4").style.display="none";
	document.getElementById("page5").style.display="none";
	document.getElementById("page6").style.display="none";
}
if (page==3)  {
	document.getElementById("page3").style.display="block";
	document.getElementById("page2").style.display="none";
	document.getElementById("page1").style.display="none";
	document.getElementById("page4").style.display="none";
	document.getElementById("page5").style.display="none";
	document.getElementById("page6").style.display="none";
}
if (page==4)  {
	document.getElementById("page4").style.display="block";
	document.getElementById("page2").style.display="none";
	document.getElementById("page1").style.display="none";
	document.getElementById("page3").style.display="none";
	document.getElementById("page5").style.display="none";
	document.getElementById("page6").style.display="none";
}
if (page==5)  {
	document.getElementById("page5").style.display="block";
	document.getElementById("page2").style.display="none";
	document.getElementById("page1").style.display="none";
	document.getElementById("page4").style.display="none";
	document.getElementById("page3").style.display="none";
	document.getElementById("page6").style.display="none";
}
if (page==6)  {
	document.getElementById("page6").style.display="block";
	document.getElementById("page2").style.display="none";
	document.getElementById("page1").style.display="none";
	document.getElementById("page4").style.display="none";
	document.getElementById("page3").style.display="none";
	document.getElementById("page5").style.display="none";
}
}

</script>
<style>
	button{
		font-size:20px;
		font-weight:800;
		width: 100%;
		height: 100%;
		background: darkgray;
		border: none;
	}
	td{
		text-align: center;
		background-color:darkgray;
		width: 200px; 
		height: 100px;
	}
	.img1{
		width: 100px; 
		height: 100px;
	}
	.td1{
		width: 1300px;
	}
    .table1{
		text-align: center;
		width: 1500px;
		height: 1300px;
		border: 1;
	}
	.table2{
		text-align: center;
		border: 1;
	}
	iframe{
		width: 1300px;
		height: 1200px;
		background-color:#6cf;
		
	}
	a{
		text-align: center;
		font-size: 25px;
		margin-top: 10px;
		font: weight 800px;
		text-decoration: none;

	}
    .span1{
		margin-left:200px;
		float: left;
		margin-top:  60px;
		font-size: 50px;
	}
	.span2{
		float: left;
		margin-left:100px;
	}
	
</style>
	<script src="Js/jquery-3.3.1.js"></script>
	<script src="Js/finduser.js"></script>
	<link rel="stylesheet" type="text/css" href="css/popup.css" />  <!--//引入css-->
	<script>
		function checkpassword1() {
			var reg_password =  /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{6,16}$/;

			var password1=$("#password1").val();

			var flag = reg_password.test(password1);
			if(password1==null||password1=="") {$("#newpas1").html("请输入密码"); return false}
			if(flag){
				$("#newpas1").html("");
				return true;}
			else {
				$("#newpas1").html("*密码格式有误,请输入至少6-16个字符，" + "<br>" + "至少1个大写字母，1个小写字母和1个数字，其他可以是任意字符;");
				return false;
			}

		}
		function checkpassword2(){
			var password2=$("#password2").val();
			var password1=$("#password1").val();
			if(password2==null||password2=="")
			{
				$("#newpas2").html("请再次输入密码！"); return false;
			}else
			{
				if(password2==password1){
					$("#newpas2").html("");
					return true}
				else {
					$("#newpas2").html("两次输入的密码不相同！")
				}

			}
		}
		function checkpass(){
			var password=$("#password").val();

			if(password==null||password=="")
			{
				$("#pas").html("请输入原密码"); return false;

			}else
			{
				if(password!=getworker().password){
					$("#pas").html("原密码错误"); return false;
				}else{
					$("#pas").html("");

					return true
				}

			}
		}
		$(function () {
			$("#fram1").attr("src",'worker/allinfor?workerid='+getworker().userid+'&p=1')
			$("#fram4").attr("src",'worker/listbill?workerid='+getworker().userid+'&p=1')
			$("#span1").text(getworker().userid);
			$("#img1").click(function () {
				if($("#div1").css("display")=='none') $("#div1").css("display","block");
				else $("#div1").css("display","none");


			})
			$("#modif_pas").click(function () {
				document.getElementById('all_light').style.display = 'block';

				document.getElementById('contes').style.display = 'block';

			})

			$("#btn1").click(function () {
				if(checkpass()&&checkpassword1()&&checkpassword2()){
					$.ajax({
						url:'worker/modifpass',
						type: 'post',
						dataType: 'json',
						data:{"num":getworker().num,"password":$("#password1").val()},
						async: false,
						success:function (message) {
							if (message.flag==1) {
								alert(message.message);
								window.location.href="login/exit"
							}else{
								alert(message.message)
							}

						}
					})
				}
				return false;
			})

			$("#password1").blur(checkpassword1);
			$("#password2").blur(checkpassword2);
			$("#password").blur(checkpass);


		})
	</script>
</head>
<body>
<table class="table1">
	<tr cellspacing="10px">
		<td>
			<div>
				<a href="manage.html" >
				  <img  class="img1" src="img/logo.png" />

			    </a>
			</div>
		</td>  
		<td colspan="6" >		
			<span class="span1" >
				上  海  海  洋  大  学  校  园  维  修  系  统
			</span>
			
			<!--此处的css未完成！-->
			<table class="table2">
				<tr><td rowspan=2>
					<span style="float: left;margin-left: 100px;">
						<img  id="img1" src="img/1.jpg" style="height: 100px;"/>
						<div id="div1" style="display: none">
						<a id="modif_pas" onclick="javascript:void(0)">修改密码</a>
						<a id="modif_tou" onclick="javascript:void(0)">修改头像</a>
					</div>
					</span>
				</td><td colspan="2">工人端</td></tr>
				<tr><td colspan="2">欢迎：<span id="span1"></span></td></tr>
			</table>
			<!--此处的css未完成！-->
		</td>
	</tr>
<tr>  <td><a href="javascript:showpage(1)">修改个人信息</a></td>  
<td class="td1" style="background-color:#6cf ;" colspan="6"  rowspan="12">
<!-- 功能对应的HTML网页 -->

	<script>

		function close1()

		{
			document.getElementById('all_light').style.display = 'none';
			document.getElementById('contes').style.display = 'none';
		}
	</script>
	<div4 id="contes" style="">

		<div5 style="width:500px;height:40px;">

			<p align="centre">修改密码</p>
			<hr>


			<form id="modifpas" >
				<table>
					<tr>
						<td>请输入原密码</td>
						<td><input type="password" id="password">
							<span id="pas"></span>
						</td>
					</tr>
					<tr>
						<td>新密码:</td>
						<td><input type="password" id="password1">
							<span id="newpas1"></span>
						</td>
					</tr>
					<tr>
						<td>再次输入新密码:</td>
						<td><input type="password" id="password2">
							<span id="newpas2"></span>
						</td>
					</tr>
					<tr>
						<td><button id="btn1">确认修改</button></td>
						<td><button id="btn2" onclick="close1()">返回</button></td>
					</tr>
				</table>
			</form>

		</div5>

	</div4>
	<div6 id="all_light">
	</div6>



<!-- 修改个人信息 -->
<div id="page1" style="display:none;">
<iframe src="W_information.html" frameborder="0" leftmargin="0"  >
</iframe>
</div>

<!-- 查看申报订单 -->
<div id="page2" style="display:none;">
<iframe  frameborder="0" leftmargin="0" id="fram1"></iframe>
</div>
	<!--填写报销单-->
	<div id="page3" style="display:none;">
		<iframe src="W_bill.html" frameborder="0" leftmargin="0" id="fram2"></iframe>
	</div>
	<!--查看报销单-->
	<div id="page4" style="display:none;">
		<iframe src="W_bill.html" frameborder="0" leftmargin="0" id="fram4"></iframe>
	</div>


<!-- 功能对应的HTML网页 -->
</td></tr>   <!-- 要添加功能，注意修改rowspan的值 -->

	<tr>  <td><a href="javascript:showpage(2)">查看维修订单</a></td></tr>
	<tr>  <td><a href="javascript:showpage(3)">填报报销单</a></td></tr>
<tr>  <td><a href="javascript:showpage(4)">查看报销单</a></td></tr>
<tr>  <td></td></tr>
<tr>  <td></td></tr>
<tr>  <td></td></tr>
<tr>  <td></td></tr>
<tr>  <td></td></tr>
<tr>  <td></td></tr>
<tr>  <td></td></tr>
<tr>  <td></td></tr>

</table>
</body>
</html>